# Diff-Match-Patch Benchmark Results

**Generated:** 2026-02-05 08:43:21

## System Context

**Current content limits:** 100,000 characters (~100KB) for bookmarks, notes, and prompts.

This means:
- Results for sizes >100KB are theoretical (content that large cannot exist)
- The 50KB-100KB range represents the upper bound of real-world usage
- Most content is likely <10KB

## Diff Computation (patch_make)

Time to compute diff between original and modified content.

**Change percentages:**
- **1%** - Small edit: ~1% of content modified (e.g., fixing a typo)
- **10%** - Medium edit: ~10% of content modified (e.g., rewriting a paragraph)
- **50%** - Large rewrite: ~50% of content modified (e.g., major restructuring)

| Size | Change | P50 (ms) | P95 (ms) | P99 (ms) | Max (ms) |
|------|--------|----------|----------|----------|----------|
| 1KB | 1% | 0.069 | 0.084 | 0.124 | 0.124 |
| 1KB | 10% | 0.025 | 0.05 | 0.05 | 0.05 |
| 1KB | 50% | 0.046 | 0.053 | 0.07 | 0.07 |
| 10KB | 1% | 0.041 | 0.058 | 0.062 | 0.062 |
| 10KB | 10% | 0.066 | 0.082 | 0.082 | 0.082 |
| 10KB | 50% | 0.718 | 0.809 | 0.813 | 0.813 |
| 50KB | 1% | 0.066 | 0.112 | 0.165 | 0.165 |
| 50KB | 10% | 0.074 | 0.105 | 0.157 | 0.157 |
| 50KB | 50% | 14.348 | 14.521 | 14.563 | 14.563 |
| 100KB | 1% | 0.118 | 0.139 | 0.183 | 0.183 |
| 100KB | 10% | 0.126 | 0.139 | 0.156 | 0.156 |
| 100KB | 50% | 56.651 | 57.382 | 57.572 | 57.572 |
| 250KB | 1% | 0.125 | 0.152 | 0.237 | 0.237 |
| 250KB | 10% | 0.269 | 0.322 | 0.37 | 0.37 |
| 250KB | 50% | 343.773 | 348.509 | 350.836 | 350.836 |
| 500KB | 1% | 0.225 | 0.247 | 0.408 | 0.408 |
| 500KB | 10% | 0.56 | 0.656 | 0.693 | 0.693 |
| 500KB | 50% | 1321.18 | 1330.462 | 1365.745 | 1365.745 |

## Reconstruction (applying sequential diffs)

Time to reconstruct content by applying N sequential diffs from a snapshot.

| Size | Diffs | P50 (ms) | P95 (ms) | P99 (ms) | Max (ms) |
|------|-------|----------|----------|----------|----------|
| 10KB | 1_diffs | 0.009 | 0.026 | 0.255 | 0.255 |
| 10KB | 5_diffs | 0.009 | 0.014 | 0.019 | 0.019 |
| 10KB | 10_diffs | 0.01 | 0.013 | 0.019 | 0.019 |
| 10KB | 20_diffs | 0.011 | 0.014 | 0.018 | 0.018 |
| 10KB | 50_diffs | 0.013 | 0.019 | 0.021 | 0.021 |
| 50KB | 1_diffs | 0.024 | 0.035 | 0.042 | 0.042 |
| 50KB | 5_diffs | 0.024 | 0.031 | 0.035 | 0.035 |
| 50KB | 10_diffs | 0.023 | 0.028 | 0.028 | 0.028 |
| 50KB | 20_diffs | 0.024 | 0.026 | 0.027 | 0.027 |
| 50KB | 50_diffs | 0.027 | 0.031 | 0.044 | 0.044 |
| 100KB | 1_diffs | 0.023 | 0.031 | 0.034 | 0.034 |
| 100KB | 5_diffs | 0.024 | 0.033 | 0.035 | 0.035 |
| 100KB | 10_diffs | 0.032 | 0.036 | 0.036 | 0.036 |
| 100KB | 20_diffs | 0.028 | 0.034 | 0.037 | 0.037 |
| 100KB | 50_diffs | 0.029 | 0.037 | 0.04 | 0.04 |
| 250KB | 1_diffs | 0.042 | 0.046 | 0.048 | 0.048 |
| 250KB | 5_diffs | 0.042 | 0.047 | 0.049 | 0.049 |
| 250KB | 10_diffs | 0.041 | 0.047 | 0.048 | 0.048 |
| 250KB | 20_diffs | 0.039 | 0.048 | 0.049 | 0.049 |
| 250KB | 50_diffs | 0.042 | 0.049 | 0.049 | 0.049 |
| 500KB | 1_diffs | 0.057 | 0.067 | 0.074 | 0.074 |
| 500KB | 5_diffs | 0.057 | 0.066 | 0.067 | 0.067 |
| 500KB | 10_diffs | 0.053 | 0.063 | 0.063 | 0.063 |
| 500KB | 20_diffs | 0.054 | 0.063 | 0.066 | 0.066 |
| 500KB | 50_diffs | 0.056 | 0.066 | 0.067 | 0.067 |

## Event Loop Impact (async degradation)

How blocking diff computation affects concurrent async operations.

| Size | Baseline P95 (ms) | Impacted P95 (ms) | Degradation |
|------|-------------------|-------------------|-------------|
| 10KB | 1.18 | 1.176 | 1.02x |
| 100KB | 1.159 | 1.169 | 1.01x |
| 250KB | 1.156 | 1.155 | 1.0x |
| 500KB | 1.155 | 1.156 | 1.0x |

## Analysis

### âš ï¸ Slow Operations (>100ms P95)

| Size | Change | P95 (ms) | Notes |
|------|--------|----------|-------|
| 250KB | 50% | 348.509 | ðŸŸ  Slow |
| 500KB | 50% | 1330.462 | ðŸ”´ Very slow |

### âœ… Fast Operations (<10ms P95)

All 1%/10% changes across all tested sizes are sub-10ms.

### Key Findings

- **50% rewrites become slow at 100KB** (57.382ms P95)
- **Typical edits (1-10% changes) are fast up to 500KB+**
- **Reconstruction is always fast** (<1ms even for 50 diffs)

## Recommendations

### For typical usage (1-10% edits):
- [x] **Sync implementation is fine** - sub-millisecond for most content
- [x] **Snapshot interval of 10 is fine** - reconstruction is negligible

### For large rewrites (50%+ changes):
- [ ] **Store snapshot instead of diff** when change > 50% of content
- [ ] **Performance degrades significantly:** 100KB: 57.382ms, 250KB: 348.509ms, 500KB: 1330.462ms


## Decision Matrix

| Metric | Threshold | Result | Decision |
|--------|-----------|--------|----------|
| P95 diff time for 50KB (10% change) | < 10ms | 0.105 ms | Sync OK |
| P95 reconstruction (10 diffs, 50KB) | < 20ms | 0.028 ms | Interval 10 OK |
| Event loop degradation at 100KB | < 2x | 1.01x | Acceptable |
| 50% change exceeds 50ms at | Note size | 100KB | Store snapshot instead |