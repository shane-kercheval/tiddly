# Diff-Match-Patch Benchmark Results

**Generated:** 2026-02-03 08:48:20

## System Context

**Current content limits:** 100,000 characters (~100KB) for bookmarks, notes, and prompts.

This means:
- Results for sizes >100KB are theoretical (content that large cannot exist)
- The 50KB-100KB range represents the upper bound of real-world usage
- Most content is likely <10KB

## Diff Computation (patch_make)

Time to compute diff between original and modified content.

**Change percentages:**
- **1%** - Small edit: ~1% of content modified (e.g., fixing a typo)
- **10%** - Medium edit: ~10% of content modified (e.g., rewriting a paragraph)
- **50%** - Large rewrite: ~50% of content modified (e.g., major restructuring)

| Size | Change | P50 (ms) | P95 (ms) | P99 (ms) | Max (ms) |
|------|--------|----------|----------|----------|----------|
| 1KB | 1% | 0.068 | 0.099 | 0.123 | 0.123 |
| 1KB | 10% | 0.024 | 0.034 | 0.048 | 0.048 |
| 1KB | 50% | 0.048 | 0.074 | 0.11 | 0.11 |
| 10KB | 1% | 0.041 | 0.051 | 0.068 | 0.068 |
| 10KB | 10% | 0.066 | 0.072 | 0.085 | 0.085 |
| 10KB | 50% | 0.715 | 0.782 | 0.785 | 0.785 |
| 50KB | 1% | 0.067 | 0.079 | 0.106 | 0.106 |
| 50KB | 10% | 0.08 | 0.095 | 0.111 | 0.111 |
| 50KB | 50% | 14.234 | 14.724 | 14.728 | 14.728 |
| 100KB | 1% | 0.12 | 0.172 | 0.205 | 0.205 |
| 100KB | 10% | 0.126 | 0.142 | 0.167 | 0.167 |
| 100KB | 50% | 56.519 | 57.407 | 57.648 | 57.648 |
| 250KB | 1% | 0.127 | 0.164 | 0.215 | 0.215 |
| 250KB | 10% | 0.281 | 0.299 | 0.302 | 0.302 |
| 250KB | 50% | 343.486 | 346.422 | 349.655 | 349.655 |
| 500KB | 1% | 0.209 | 0.334 | 0.353 | 0.353 |
| 500KB | 10% | 0.531 | 0.668 | 0.672 | 0.672 |
| 500KB | 50% | 1338.059 | 1348.982 | 1349.573 | 1349.573 |

## Reconstruction (applying sequential diffs)

Time to reconstruct content by applying N sequential diffs from a snapshot.

| Size | Diffs | P50 (ms) | P95 (ms) | P99 (ms) | Max (ms) |
|------|-------|----------|----------|----------|----------|
| 10KB | 1_diffs | 0.009 | 0.025 | 0.206 | 0.206 |
| 10KB | 5_diffs | 0.01 | 0.02 | 0.024 | 0.024 |
| 10KB | 10_diffs | 0.01 | 0.015 | 0.017 | 0.017 |
| 10KB | 20_diffs | 0.011 | 0.014 | 0.019 | 0.019 |
| 10KB | 50_diffs | 0.013 | 0.021 | 0.032 | 0.032 |
| 50KB | 1_diffs | 0.023 | 0.032 | 0.042 | 0.042 |
| 50KB | 5_diffs | 0.023 | 0.033 | 0.036 | 0.036 |
| 50KB | 10_diffs | 0.023 | 0.027 | 0.036 | 0.036 |
| 50KB | 20_diffs | 0.024 | 0.033 | 0.037 | 0.037 |
| 50KB | 50_diffs | 0.027 | 0.032 | 0.034 | 0.034 |
| 100KB | 1_diffs | 0.029 | 0.046 | 0.049 | 0.049 |
| 100KB | 5_diffs | 0.027 | 0.038 | 0.05 | 0.05 |
| 100KB | 10_diffs | 0.031 | 0.043 | 0.047 | 0.047 |
| 100KB | 20_diffs | 0.031 | 0.038 | 0.041 | 0.041 |
| 100KB | 50_diffs | 0.034 | 0.044 | 0.048 | 0.048 |
| 250KB | 1_diffs | 0.04 | 0.046 | 0.049 | 0.049 |
| 250KB | 5_diffs | 0.038 | 0.044 | 0.044 | 0.044 |
| 250KB | 10_diffs | 0.039 | 0.059 | 0.06 | 0.06 |
| 250KB | 20_diffs | 0.04 | 0.052 | 0.053 | 0.053 |
| 250KB | 50_diffs | 0.043 | 0.052 | 0.052 | 0.052 |
| 500KB | 1_diffs | 0.059 | 0.067 | 0.071 | 0.071 |
| 500KB | 5_diffs | 0.072 | 0.092 | 0.106 | 0.106 |
| 500KB | 10_diffs | 0.072 | 0.074 | 0.085 | 0.085 |
| 500KB | 20_diffs | 0.058 | 0.065 | 0.066 | 0.066 |
| 500KB | 50_diffs | 0.075 | 0.084 | 0.092 | 0.092 |

## Event Loop Impact (async degradation)

How blocking diff computation affects concurrent async operations.

| Size | Baseline P95 (ms) | Impacted P95 (ms) | Degradation |
|------|-------------------|-------------------|-------------|
| 10KB | 1.166 | 1.167 | 1.01x |
| 100KB | 1.161 | 1.159 | 0.99x |
| 250KB | 1.16 | 1.161 | 1.0x |
| 500KB | 1.154 | 1.152 | 1.0x |

## Analysis

### âš ï¸ Slow Operations (>100ms P95)

| Size | Change | P95 (ms) | Notes |
|------|--------|----------|-------|
| 250KB | 50% | 346.422 | ðŸŸ  Slow |
| 500KB | 50% | 1348.982 | ðŸ”´ Very slow |

### âœ… Fast Operations (<10ms P95)

All 1%/10% changes across all tested sizes are sub-10ms.

### Key Findings

- **50% rewrites become slow at 100KB** (57.407ms P95)
- **Typical edits (1-10% changes) are fast up to 500KB+**
- **Reconstruction is always fast** (<1ms even for 50 diffs)

## Recommendations

### For typical usage (1-10% edits):
- [x] **Sync implementation is fine** - sub-millisecond for most content
- [x] **Snapshot interval of 10 is fine** - reconstruction is negligible

### For large rewrites (50%+ changes):
- [ ] **Store snapshot instead of diff** when change > 50% of content
- [ ] **Performance degrades significantly:** 100KB: 57.407ms, 250KB: 346.422ms, 500KB: 1348.982ms


## Decision Matrix

| Metric | Threshold | Result | Decision |
|--------|-----------|--------|----------|
| P95 diff time for 50KB (10% change) | < 10ms | 0.095 ms | Sync OK |
| P95 reconstruction (10 diffs, 50KB) | < 20ms | 0.027 ms | Interval 10 OK |
| Event loop degradation at 100KB | < 2x | 0.99x | Acceptable |
| 50% change exceeds 50ms at | Note size | 100KB | Store snapshot instead |